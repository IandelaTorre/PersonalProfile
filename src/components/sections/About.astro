---
import { getLangFromUrl, useTranslations } from "../../i18n/utils";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const hobbies = [
  { name: lang === "en" ? "Reading" : "Lectura", icon: "üìö" },
  { name: lang === "en" ? "Gaming" : "Videojuegos", icon: "üéÆ" },
  { name: lang === "en" ? "Sports" : "Deporte", icon: "üèÉ" },
  { name: lang === "en" ? "Music" : "M√∫sica", icon: "üéµ" },
];
---

<section id="about" class="relative">
  <div
    class="about-container h-screen flex flex-col items-center justify-center overflow-hidden dark:bg-neutral-900"
  >
    <!-- Header: Avatar + Name -->
    <div class="about-header flex flex-col items-center z-10">
      <img
        src="https://images.unsplash.com/photo-1568602471122-7832951cc4c5?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=facearea&facepad=2&w=300&h=300&q=80"
        alt="Avatar"
        class="about-avatar w-40 h-40 sm:w-64 sm:h-64 rounded-full object-cover shadow-2xl border-4 border-white dark:border-neutral-800"
      />
      <h2
        class="about-name text-3xl sm:text-5xl font-bold mt-6 text-gray-800 dark:text-white"
      >
        {t("about.name")}
      </h2>
    </div>

    <!-- Content: Description + Hobbies -->
    <div
      class="about-content absolute top-1/2 pt-32 opacity-0 text-center max-w-2xl px-4 translate-y-20"
    >
      <h3 class="text-2xl font-bold mb-6 text-gray-800 dark:text-white">
        {t("about.title")}
      </h3>
      <p
        class="text-lg text-gray-600 dark:text-neutral-400 leading-relaxed mb-10"
      >
        {t("about.description")}
      </p>

      <div class="flex flex-wrap justify-center gap-4">
        {
          hobbies.map((hobby) => (
            <span class="inline-flex items-center gap-x-2 py-2 px-4 rounded-full text-sm font-medium bg-white border border-gray-200 shadow-sm text-gray-800 dark:bg-neutral-800 dark:border-neutral-700 dark:text-white">
              <span>{hobby.icon}</span>
              {hobby.name}
            </span>
          ))
        }
      </div>
    </div>
  </div>
</section>

<script>
  import gsap from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  const mm = gsap.matchMedia();

  mm.add("(min-width: 640px)", () => {
    // Desktop Animation
    const tl = gsap.timeline({
      scrollTrigger: {
        trigger: "#about",
        start: "top top",
        end: "+=2000", // Increased scroll distance
        scrub: 1,
        pin: true,
        anticipatePin: 1,
      },
    });

    tl.to(".about-avatar", {
      scale: 0.25,
      y: -window.innerHeight * 0.35,
      duration: 1,
    })
      .to(
        ".about-name",
        {
          scale: 1.2,
          y: -window.innerHeight * 0.35,
          duration: 1,
        },
        "<",
      )
      .to(
        ".about-content",
        {
          opacity: 1,
          y: 0,
          duration: 1,
        },
        "-=0.5",
      ); // Overlap slightly
  });

  mm.add("(max-width: 639px)", () => {
    // Mobile Animation
    const tl = gsap.timeline({
      scrollTrigger: {
        trigger: "#about",
        start: "top top",
        end: "+=1500",
        scrub: 1,
        pin: true,
        anticipatePin: 1,
      },
    });

    tl.to(".about-avatar", {
      scale: 0.3,
      y: -window.innerHeight * 0.3,
      duration: 1,
    })
      .to(
        ".about-name",
        {
          scale: 1.1,
          y: -window.innerHeight * 0.3,
          duration: 1,
        },
        "<",
      )
      .to(
        ".about-content",
        {
          opacity: 1,
          y: -50,
          duration: 1,
        },
        "-=0.5",
      );
  });
</script>
