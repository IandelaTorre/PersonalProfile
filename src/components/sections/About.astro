---
import { getLangFromUrl, useTranslations } from "../../i18n/utils";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const hobbies = [
  { name: t("about.hobbies.hobbie1.title"), icon: t("about.hobbies.hobbie1.icon") },
  { name: t("about.hobbies.hobbie2.title"), icon: t("about.hobbies.hobbie2.icon") },
  { name: t("about.hobbies.hobbie3.title"), icon: t("about.hobbies.hobbie3.icon") },
  { name: t("about.hobbies.hobbie4.title"), icon: t("about.hobbies.hobbie4.icon") },
];
---

<section id="about" class="relative mb-24 md:mb-28">
  <div
    class="about-container min-h-screen sm:h-screen flex flex-col items-center justify-start pt-32 sm:justify-center sm:pt-0 overflow-hidden dark:bg-neutral-900"
  >
    <!-- Header: Avatar + Name -->
    <div class="about-header flex flex-col items-center z-10">
      <h2
        class="about-name text-3xl sm:text-5xl font-bold text-gray-800 dark:text-white"
      >
        {t("about.name")}
      </h2>
      <img
        src="/images/avatarRecortado.png"
        alt="Avatar"
        class="about-avatar w-40 h-40 sm:w-64 sm:h-64 mt-6 rounded-full object-cover shadow-2xl border-4 border-white dark:border-neutral-800 bg-amber-50"
      />
    </div>

    <!-- Content: Description + Hobbies -->
    <div
      class="about-content relative sm:absolute sm:top-1/2 mt-10 sm:mt-0 sm:pt-32 opacity-0 text-center max-w-2xl px-4 translate-y-20"
    >
      <h3 class="text-2xl font-bold mb-6 text-gray-800 dark:text-white">
        {t("about.title")}
      </h3>
      <p
        class="text-lg text-justify text-gray-600 dark:text-neutral-400 leading-relaxed mb-10"
      >
        {t("about.description")}
      </p>

      <div class="flex flex-wrap justify-center gap-4">
        {
          hobbies.map((hobby) => (
            <span class="inline-flex items-center gap-x-2 py-2 px-4 rounded-full text-sm font-medium bg-white border border-gray-200 shadow-sm text-gray-800 dark:bg-neutral-800 dark:border-neutral-700 dark:text-white">
              <span>{hobby.icon}</span>
              {hobby.name}
            </span>
          ))
        }
      </div>
    </div>
  </div>
</section>

<script>
  import gsap from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  const mm = gsap.matchMedia();

  mm.add("(min-width: 640px)", () => {
    // Desktop Animation
    const tl = gsap.timeline({
      scrollTrigger: {
        trigger: "#about",
        start: "top top",
        end: "+=300",
        scrub: 1,
        pin: true,
        anticipatePin: 1,
      },
    });

    tl.to(".about-avatar", {
      scale: 0.25,
      y: -window.innerHeight * 0.35,
      duration: 1,
    })
      .to(
        ".about-name",
        {
          scale: 1.2,
          y: -window.innerHeight * 0.35,
          duration: 1,
        },
        "<",
      )
      .to(
        ".about-content",
        {
          opacity: 1,
          y: 0,
          duration: 1,
        },
        "-=0.5",
      );
  });

  mm.add("(max-width: 639px)", () => {
    // Mobile Animation
    const tl = gsap.timeline({
      scrollTrigger: {
        trigger: "#about",
        start: "top top",
        end: "+=200",
        scrub: 1,
        pin: true,
        anticipatePin: 1,
      },
    });

    tl.to(".about-avatar", {
      scale: 0.3,
      y: -window.innerHeight * 0.2,
      duration: 1,
    })
      .to(
        ".about-name",
        {
          scale: 1.1,
          y: -window.innerHeight * 0.2,
          duration: 1,
        },
        "<",
      )
      .to(
        ".about-content",
        {
          opacity: 1,
          y: -50,
          duration: 1,
        },
        "-=0.5",
      );
  });
</script>
