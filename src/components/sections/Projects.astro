---
import Card from "../ui/Card.astro";
import Badge from "../ui/Badge.astro";
import { getLangFromUrl, useTranslations } from "../../i18n/utils";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const projects = [
  {
    title: "iOS Weather App",
    description:
      lang === "en"
        ? "A clean, minimalist weather application built with SwiftUI using open weather APIs. Features include location-based forecasts, severe weather alerts, and beautiful animations."
        : "Una aplicación del clima limpia y minimalista construida con SwiftUI usando APIs abiertas. Incluye pronósticos basados en ubicación, alertas de clima severo y hermosas animaciones.",
    tags: ["Swift", "SwiftUI", "CoreLocation"],
    image:
      "https://images.unsplash.com/photo-1592210454359-9043f067919b?auto=format&fit=crop&w=900&q=80",
    type: "iOS",
  },
  {
    title: "E-commerce Dashboard",
    description:
      lang === "en"
        ? "Full-stack admin dashboard for managing products, orders, and customers. Built with React, NestJS, and PostgreSQL. Includes real-time analytics and role-based access control."
        : "Dashboard administrativo full-stack para gestionar productos, pedidos y clientes. Construido con React, NestJS y PostgreSQL. Incluye analíticas en tiempo real y control de acceso basado en roles.",
    tags: ["React", "NestJS", "PostgreSQL", "Tailwind"],
    image:
      "https://images.unsplash.com/photo-1551288049-bebda4e38f71?auto=format&fit=crop&w=900&q=80",
    type: "Full-Stack",
  },
  {
    title: "Task Manager",
    description:
      lang === "en"
        ? "Productivity app focused on getting things done. Features include iCloud sync, custom categories, and dark mode support. Built with UIKit and CoreData."
        : "App de productividad enfocada en completar tareas. Incluye sincronización con iCloud, categorías personalizadas y soporte para modo oscuro. Construida con UIKit y CoreData.",
    tags: ["Swift", "UIKit", "CoreData"],
    image:
      "https://images.unsplash.com/photo-1484480974693-6ca0a78fb36b?auto=format&fit=crop&w=900&q=80",
    type: "iOS",
  },
];
---

<section
  id="projects"
  class="max-w-[85rem] px-4 py-10 sm:px-6 lg:px-8 lg:py-14 mx-auto"
>
  <div class="max-w-2xl mx-auto text-center mb-10 lg:mb-14">
    <h2 class="text-2xl font-bold md:text-4xl md:leading-tight dark:text-white">
      {t("projects.title")}
    </h2>
    <p class="mt-1 text-gray-600 dark:text-neutral-400">
      {t("projects.viewAll")}
    </p>
  </div>

  <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
    {
      projects.map((project) => (
        <Card
          href="#"
          class="project-card h-full opacity-0 translate-y-12 scale-95"
        >
          <div class="aspect-w-16 aspect-h-9 mb-4 overflow-hidden rounded-xl">
            <img
              class="w-full h-48 object-cover rounded-xl transition-transform duration-500 hover:scale-105"
              src={project.image}
              alt={project.title}
            />
          </div>
          <div class="flex flex-col h-full">
            <div class="flex justify-between items-center mb-2">
              <Badge label={project.type} color="purple" />
            </div>
            <h3 class="text-xl font-bold text-gray-800 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-500">
              {project.title}
            </h3>
            <p class="mt-3 text-gray-600 dark:text-neutral-400 flex-grow">
              {project.description}
            </p>
            <div class="mt-4 flex flex-wrap gap-2">
              {project.tags.map((tag) => (
                <span class="inline-flex items-center gap-x-1.5 py-1 px-2 rounded-md text-xs font-medium bg-gray-100 text-gray-800 dark:bg-white/10 dark:text-white">
                  {tag}
                </span>
              ))}
            </div>
          </div>
        </Card>
      ))
    }
  </div>
</section>

<script>
  import gsap from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  ScrollTrigger.batch(".project-card", {
    start: "top 80%",
    onEnter: (elements) => {
      gsap.to(elements, {
        opacity: 1,
        y: 0,
        scale: 1,
        duration: 0.8,
        stagger: 0.15,
        ease: "power3.out",
      });
    },
    once: true,
  });
</script>
